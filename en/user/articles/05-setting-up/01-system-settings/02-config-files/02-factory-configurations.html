<p>&mdash;</p><h2>header-id: factory-configurations</h2><h1>Factory Configurations</h1><p>[TOC levels=1-4]</p><p>Configurations supporting multiple entries are called <em>factory configurations</em>. </p><p>| <strong>Factory Configuration Example:</strong> JAX-WS and JAX-RS web services are | supported. These services must use a CXF Endpoint, which is a context path where | the web services are deployed and accessed. Endpoints can be created via | factory configuration by navigating to the CXF Endpoints entry in System | Settings (System Settings &rarr; Platform &rarr; Web API &rarr; CXF Endpoints). | Click <em>ADD</em>, enter the desired configuration values, then repeat the process to | add as many CXF Endpoint configurations as needed. Creating CXF Endpoint | configurations also creates CXF Endpoints themselves. This is how factory | configurations work.</p><p>If a service is meant to support factory configurations, its System Settings entry has an ADD button. </p><p><img src="../../../../images/factory-configuration-entry.png" alt="Figure 1" /><p class="caption">Figure 1: If a System Settings entry has an ADD button, it&rsquo;s suitable for factory configurations.</p><p>As with single-instance configurations, you can set factory configurations in the System Settings interface (as described in the example above) or via configuration files. Name a standard single-instance configuration file like this: </p>
<pre><code>my.service.ServiceConfiguration.config
</code></pre><p>If your service supports factory configurations, use the convention of calling the configuration&rsquo;s first instance <code>-default.config</code>: </p>
<pre><code>my.service.ServiceConfiguration-default.config
</code></pre><p>The next instance contains a unique <em>subname</em> (something other than <em>default</em>). It&rsquo;s good practice to use a descriptive name: </p>
<pre><code>my.service.ServiceConfiguration-port9080.config
</code></pre><p>To follow the CXF Endpoints example described above, if Liferay&rsquo;s developers had shipped an initial CXF Endpoint <code>.config</code> file with @product@, it would have been named this: </p>
<pre><code>com.liferay.portal.remote.cxf.common.configuration.CXFEndpointPublisherConfiguration-default.config
</code></pre><p>If this <code>-default.config</code> configuration specifies a context path for <em>REST</em> web services, and you create another endpoint with a different context path for <em>SOAP</em> web services, your second configuration file could be named: </p>
<pre><code>com.liferay.portal.remote.cxf.common.configuration.CXFEndpointPublisherConfiguration-soap.config
</code></pre><p>| <strong>Note:</strong> Some System Settings entries (like the CXF Endpoints entry) don&rsquo;t ship | with a configuration file, so anything you create is the first occurrence. | However, if you configure one and export it to obtain the <code>.config</code> file, it | doesn&rsquo;t use the <code>-default.config</code> naming convention. Instead it&rsquo;s given a | guaranteed unique identifier for its subname, like this: | | com.liferay.portal.remote.cxf.common.configuration.CXFEndpointPublisherConfiguration-a6f67e48-6dca-49c6-bf6b-8fd5e6016b2d.config | | This guarantees that the file has a unique name. If you&rsquo;re exporting the | configuration file for deployment in a separate system, you can rename | the exported file to use a more descriptive subname. If you rename the file and | deploy it to the same system it was exported from, the new subname marks it as | an entirely new configuration. You&rsquo;ll end up with an additional configuration | instance in this case, not just a renamed one.</p><p>| <strong>Warning::</strong> For configuration entries supporting factory configurations, | omitting the subname from a <code>.config</code> file&rsquo;s name causes System Settings to | disallow adding new entries for the configuration (only the configuration entry | targeted by this <code>.config</code> file). This is caused by a known bug. See | <a href="https://issues.liferay.com/browse/LPS-76352">LPS-76352</a> | for more information. Once an improperly named configuration file is deployed, | you can&rsquo;t add any entries for the configuration in question from its System | Settings entry. For example, if you deploy the following file to configure a CXF | Endpoint, not only does this not add a CXF Endpoint, it also prevents you from | adding any CXF Endpoints via System Settings: | | com.liferay.portal.remote.cxf.common.configuration.CXFEndpointPublisherConfiguration.config | | Deploying an erroneous (lacking a subname) <code>.config</code> file doesn&rsquo;t disable | anything permanently. Just rename the file using the proper convention described | above or remove it entirely and start over.</p><p>In many cases, configuration files can be used to force a factory configuration scenario, but not all configurations can be used this way. It&rsquo;s best to stick to the intended use cases. Use System Settings as described above to determine if using factory configurations is a good idea. If not, stick to the single occurrence mode of configuration (specifying only one configuration file for the service). </p>
